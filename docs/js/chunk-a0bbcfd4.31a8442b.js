(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a0bbcfd4"],{"2c88":function(e,a,t){"use strict";t.r(a);var r=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("a-card",{attrs:{bordered:!1}},[this.$route.query.id?t("h2",[e._v("文章详情")]):t("h2",[e._v("新增文章")]),t("a-form",{attrs:{form:e.form},on:{submit:e.articleSubmit}},[t("a-row",[t("a-col",{staticClass:"search-item-col",staticStyle:{display:"block"},attrs:{lg:{span:14},md:{span:24}}},[t("a-form-item",{staticClass:"search-item",attrs:{label:"文章类型",labelCol:e.searchCol.labelCol,wrapperCol:e.searchCol.wrapperCol}},[t("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["type",{rules:[{required:!0,message:"请选择文章类型"}]}],expression:"['type',{rules: [{required:true , message: '请选择文章类型'}]}]"}],attrs:{placeholder:"请选择",hasFeedback:""},on:{change:e.changeArticleType}},[t("a-select-option",{attrs:{value:"1"}},[e._v("非视频类")]),t("a-select-option",{attrs:{value:"0"}},[e._v("视频类")]),t("a-select-option",{attrs:{value:"2"}},[e._v("外链类")])],1)],1)],1),t("a-col",{staticStyle:{display:"block"},attrs:{lg:{span:14},md:{span:24}}},[t("a-form-item",{staticClass:"search-item",attrs:{label:"文章标题",labelCol:e.searchCol.labelCol,wrapperCol:e.searchCol.wrapperCol}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["title",{rules:[{required:!0,message:"请填写标题"},{whitespace:!0,message:"请勿输入空格"}]}],expression:"['title', { rules: [{ required: true, message: '请填写标题' },{ whitespace: true, message: '请勿输入空格'}] }]"}],attrs:{placeholder:"文章标题"}})],1)],1),t("a-col",{staticClass:"search-item-col",attrs:{lg:{span:14},md:{span:24}}},[t("a-form-item",{staticClass:"search-item",attrs:{label:"文章作者",labelCol:e.searchCol.labelCol,wrapperCol:e.searchCol.wrapperCol}},[t("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["authorId",{rules:[{required:!0,message:"请选择作者"}]}],expression:"['authorId',{rules:[{required: true, message:'请选择作者'}]}]"}],attrs:{placeholder:"请选择"}},e._l(e.allAuthor,function(a){return t("a-select-option",{key:a.id},[e._v(e._s(a.name))])}),1)],1)],1),t("a-col",{staticClass:"search-item-col mediaModeFather",attrs:{lg:{span:13},md:{span:24}}},[t("a-form-item",{staticClass:"search-item mediaModelLeft",attrs:{label:"封面图"}},[t("a-upload",{directives:[{name:"decorator",rawName:"v-decorator",value:["headImage",{rules:[{required:!0,message:"请上传封面图"},{validator:e.validatePass}]}],expression:"['headImage', { rules: [{ required: true, message: '请上传封面图' }, {validator: validatePass}] }]"}],staticClass:"avatar-uploader",attrs:{listType:"picture-card",showUploadList:!1,action:"//jsonplaceholder.typicode.com/posts/",beforeUpload:e.beforeUpload,accept:"image/png, image/jpeg, image/jpg"}},[e.headImage?t("img",{staticClass:"img maxImg",attrs:{src:e.headImage,alt:"avatar"}}):t("div",[t("a-icon",{attrs:{type:e.loading?"loading":"plus"}}),t("div",{staticClass:"ant-upload-text"},[e._v("上传图片")])],1)])],1),0==e.articleType?t("a-form-item",{staticClass:"search-item mediaModelRight",attrs:{label:"视频"}},[t("a-upload",{directives:[{name:"decorator",rawName:"v-decorator",value:["avatarVideo",{rules:[{required:!0,message:"请上传视频"}]}],expression:"['avatarVideo', { rules: [{ required: true, message: '请上传视频' }] }]"}],staticClass:"avatar-uploader",attrs:{listType:"picture-card",showUploadList:!1,action:"//jsonplaceholder.typicode.com/posts/",beforeUpload:e.beforeUploadVideo}},[e.videoUrl?t("img",{staticClass:"img maxImg",attrs:{src:e.videoUrl,alt:"avatar"}}):t("div",[t("a-icon",{attrs:{type:e.loading?"loading":"plus"}}),t("div",{staticClass:"ant-upload-text"},[e._v("上传视频")])],1)])],1):e._e()],1),2!=e.articleType?t("a-col",{staticClass:"contentText",attrs:{span:14}},[t("a-form-item",{attrs:{label:"正文",hasFeedback:""}},[t("editor",{directives:[{name:"decorator",rawName:"v-decorator",value:["content"],expression:"['content', ]"}],ref:"editor",attrs:{tipContent:e.addText},on:{shotContent:e.getContent}})],1)],1):e._e(),"2"==e.articleType?t("a-col",{attrs:{lg:{span:14},md:{span:24}}},[t("a-form-item",{staticClass:"search-item",attrs:{label:"外链地址",labelCol:e.searchCol.labelCol,wrapperCol:e.searchCol.wrapperCol}},[t("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["outsideUrl",{rules:[{required:!0,message:"请填写外链地址"},{whitespace:!0,message:"请勿输入空格"}]}],expression:"['outsideUrl', { rules: [{ required: true, message: '请填写外链地址' },{ whitespace: true, message: '请勿输入空格'}]}]"}],attrs:{placeholder:"外链地址"}})],1)],1):e._e(),t("a-col",{staticClass:"search-item-col",attrs:{lg:{span:14},md:{span:24}}},[t("a-form-item",{staticClass:"search-item",attrs:{label:"是否推荐",labelCol:e.searchCol.labelCol,wrapperCol:e.searchCol.wrapperCol,hasFeedback:""}},[t("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["recommend",{rules:[{required:!0,message:"请选择是否推荐"}]}],expression:"['recommend',{rules:[{required:true,message:'请选择是否推荐'}]}]"}],attrs:{placeholder:"请选择"}},[t("a-select-option",{attrs:{value:"1"}},[e._v("推荐")]),t("a-select-option",{attrs:{value:"0"}},[e._v("不推荐")])],1)],1)],1),t("a-col",{staticClass:"search-item-col",attrs:{lg:{span:14},md:{span:24}}},[t("a-form-item",{staticClass:"search-item",attrs:{label:"投票标签",labelCol:e.searchCol.labelCol,wrapperCol:e.searchCol.wrapperCol}},[t("a-checkbox-group",{attrs:{options:e.tagsName},on:{change:e.onChange},model:{value:e.value,callback:function(a){e.value=a},expression:"value"}})],1)],1),t("a-col",{staticClass:"search-item-col",attrs:{lg:{span:14},md:{span:24}}},[t("a-form-item",{staticClass:"search-item",attrs:{label:"发布时间",labelCol:e.searchCol.labelCol,wrapperCol:e.searchCol.wrapperCol,hasFeedback:""}},[t("a-date-picker",{directives:[{name:"decorator",rawName:"v-decorator",value:["releaseTime",{rules:[{required:!1,message:"请选择发布时间"}]}],expression:"['releaseTime',{rules:[{required:false,message:'请选择发布时间'}]}]"}],attrs:{format:"YYYY-MM-DD HH:mm:ss",showTime:{defaultValue:e.moment("00:00:00","HH:mm:ss")}},on:{change:e.publishTimer}})],1)],1),t("a-col",{staticClass:"search-item-col",attrs:{lg:{span:24},md:{span:24}}},[t("span",{staticClass:"button-sub"},[t("a-button",{attrs:{disabled:e.buttonState},on:{click:function(a){return e.save()}}},[e._v("保存")]),t("a-button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary","html-type":"submit",disabled:e.buttonState}},[e._v("发布")])],1)])],1)],1)],1)},s=[],l=t("f499"),i=t.n(l),o=(t("7f7f"),t("a481"),t("c37f")),n=t("da05"),c=t("c1df"),u=t.n(c),d=(t("9fb0"),t("ca00")),m=t("fac5"),p=t("3e29"),h=t("b9cf"),g=t("88bc"),f=t.n(g),v=function(e,a,t){if(a&&a.file){var r="image/jpeg"===a.file.type||"image/png"===a.file.type||"image/jpg"===a.file.type;r||t(new Error("请上传JPEG,PNG,JPG图片"));var s=a.file.size/1024/1024<10;s||t(new Error("请上传小于10M的JPEG,PNG,JPG图片"))}t()},b={components:{ACol:n["b"],Editor:o["a"]},data:function(){return{validatePass:v,richContent:null,searchCol:{labelCol:{md:{span:3},lg:{span:3}},wrapperCol:{md:{span:14},lg:{span:14}}},form:this.$form.createForm(this),previewVisible:!1,videoUrl:null,fileList:[],fileListVideo:[],tags:[],allAuthor:[],articleType:1,publishTime:"",tagsName:[],tagsId:[],value:[],loading:!1,headImage:null,addText:null,buttonState:!1}},methods:{test:function(){this.$router.replace("/consulation/list")},onChange:function(){},log:function(e){this.tags.splice(e,1)},handleCancel:function(){this.previewVisible=!1},handlePreview:function(e){this.previewVisible=!0},handleChange:function(e){var a=e.fileList;this.fileList=a},handleChangeVideo:function(e){var a=e.fileList;this.fileListVideo=a},beforeUpload:function(e){var a=this,t="image/jpeg"===e.type||"image/png"===e.type||"image/jpg"===e.type,r=e.size/1024/1024<10;return r&&t?(this.avatarFile=e,this.loading=!0,Object(d["c"])(this.avatarFile).then(function(e){a.headImage=e.url,console.info("图片上传成功"+e),a.loading=!1}),!1):(this.headImage="",!1)},beforeUploadVideo:function(e){var a=this,t="image/jpeg"===e.type||"image/png"===e.type||"image/jpg"===e.type;return t?(this.avatarFile=e,this.loading=!0,Object(d["c"])(this.avatarFile).then(function(e){a.videoUrl=e.url,console.info("视频上传成功"+e),a.loading=!1}),!1):(this.headImage="",!1)},moment:u.a,range:function(e,a){for(var t=[],r=e;r<a;r++)t.push(r);return t},disabledDate:function(e){},disabledDateTime:function(){var e=this;return{disabledMinutes:function(){return e.range(0)}}},publishTimer:function(e,a){console.log(e,a),this.publishTime=a},getContent:function(e){this.richContent=e.editorContent},articleSubmit:function(e){var a=this;e.preventDefault(),this.form.validateFields(function(e,t){e||(t.content=a.richContent,t.headImage=a.headImage,t.videoUrl=a.videoUrl,t.tagIds=a.value,t.status=1,t.releaseTime=a.publishTime,a.$route.query.id&&(t.id=a.$route.query.id),console.log(t),Object(h["a"])(t).then(function(e){console.log(e),1==e.result?(alert("发布成功"),a.buttonState=!0,setTimeout(function(){a.$router.replace("/consulation/list")},1e3)):alert(e.message)}))})},save:function(){var e=this;this.form.validateFields(function(a,t){a||(t.content=e.richContent,t.headImage=e.headImage,t.videoUrl=e.videoUrl,t.tagIds=e.value,t.status=0,t.releaseTime=e.publishTime,e.$route.query.id&&(t.id=e.$route.query.id),console.log(t),Object(h["a"])(t,0).then(function(a){console.log(a),1==a.result?(alert("保存成功"),e.buttonState=!0,setTimeout(function(){e.$router.replace("/consulation/list")},1e3)):alert(a.message)}))})},changeArticleType:function(e){this.articleType=e}},watch:{},activated:function(){var e=this;this.tagsName=[],this.tagsId=[],Object(m["c"])().then(function(a){e.tags=a.object;for(var t=0;t<e.tags.length;t++)e.tagsName.push(e.tags[t].name),e.tagsId.push(e.tags[t].id)}),Object(p["c"])().then(function(a){e.allAuthor=a.object}),this.$route.query.id&&Object(h["c"])(this.$route.query.id).then(function(a){var t=JSON.parse(i()(a.object));if(console.log(t),t.releaseTime=t.releaseTime?u()(t.releaseTime):null,t.recommend+="",t.type+="",t.authorId+="",e.articleType=t.type,null!=t.tags)for(var r=t.tags,s=0;s<r.length;s++)e.value.push(r[s].name);e.headImage=t.headImage,e.videoUrl=t.videoUrl,e.addText=t.content,e.$nextTick(function(){"2"===e.articleType?e.form.setFieldsValue(f()(t,"title","authorId","releaseTime","recommend","type","outsideUrl","headImage")):e.form.setFieldsValue(f()(t,"title","releaseTime","authorId","recommend","type","headImage"))})})}},C=b,y=(t("bfa1"),t("2877")),w=Object(y["a"])(C,r,s,!1,null,null,null);a["default"]=w.exports},a21f:function(e,a,t){var r=t("584a"),s=r.JSON||(r.JSON={stringify:JSON.stringify});e.exports=function(e){return s.stringify.apply(s,arguments)}},b2d7:function(e,a,t){},b9cf:function(e,a,t){"use strict";t.d(a,"a",function(){return i}),t.d(a,"d",function(){return o}),t.d(a,"b",function(){return n}),t.d(a,"e",function(){return c}),t.d(a,"c",function(){return u});var r=t("b775"),s=t("9fb0"),l=s["l"];function i(e){return Object(r["b"])({url:l+"/inforArticle/add",method:"post",data:e})}function o(e){return Object(r["b"])({url:l+"/inforArticle/page",method:"post",data:e})}function n(e){return Object(r["b"])({url:l+"/survey/save",method:"post",data:e})}function c(e){return Object(r["b"])({url:l+"/survey/getById/"+e,method:"get"})}function u(e){return Object(r["b"])({url:l+"/inforArticle/detail?id="+e,method:"post"})}},bfa1:function(e,a,t){"use strict";var r=t("b2d7"),s=t.n(r);s.a},f499:function(e,a,t){e.exports=t("a21f")}}]);