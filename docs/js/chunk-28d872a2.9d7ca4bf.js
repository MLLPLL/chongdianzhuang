(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-28d872a2"],{"0209":function(t,e,n){"use strict";var a=n("1781"),r=n.n(a);r.a},1781:function(t,e,n){},5040:function(t,e,n){"use strict";n.d(e,"a",function(){return s}),n.d(e,"b",function(){return c}),n.d(e,"c",function(){return i});var a=n("b775"),r=n("9fb0"),o=r["l"];function s(t){return Object(a["b"])({url:o+"/content/delete/"+t,method:"get"})}function c(t){return Object(a["b"])({url:o+"/content/down/"+t,method:"get"})}function i(t,e){return Object(a["b"])({url:o+"/content/recommend/"+t+"/"+e,method:"get"})}},af85:function(t,e,n){"use strict";n.d(e,"a",function(){return a}),n.d(e,"c",function(){return r}),n.d(e,"b",function(){return o});var a={xs:{span:6},sm:{span:6}},r={xs:{span:15},sm:{span:15}},o={labelCol:{xs:{span:6},sm:{span:12},lg:{span:3}},wrapperCol:{xs:{span:6},sm:{span:12},lg:{span:4}}}},f74f:function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"commentList"}},[n("a-card",{attrs:{bordered:!1}},[n("div",{staticClass:"table-page-search-wrapper"},[n("a-form",{attrs:{form:t.form,layout:"inline"}},[n("a-row",{attrs:{type:"flex"}},[n("a-col",{attrs:{lg:{span:12},md:{span:12},sm:{span:12}}},[n("a-form-item",{staticClass:"search-item",attrs:{label:"发表者",labelCol:t.searchCol.labelCol,wrapperCol:t.searchCol.wrapperCol}},[n("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["userName"],expression:"['userName']"}]})],1)],1),n("a-col",{attrs:{lg:{span:12},md:{span:12},sm:{span:12}}},[n("a-form-item",{staticClass:"search-item",attrs:{label:"来源文章",labelCol:t.searchCol.labelCol,wrapperCol:t.searchCol.wrapperCol}},[n("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["fromText"],expression:"['fromText']"}]})],1)],1),n("a-col",{attrs:{lg:{span:12},md:{span:12},sm:{span:12}}},[n("span",{staticClass:"table-page-search-submitButtons"},[n("a-button",{attrs:{type:"primary"},on:{click:function(e){return t.search()}}},[t._v("查询")]),n("a-button",{staticStyle:{"margin-left":"8px"},on:{click:function(e){return t.reset()}}},[t._v("重置")])],1)])],1)],1)],1),n("a-row",{attrs:{gutter:8}},[n("a-col",[n("s-table",{ref:"table",attrs:{data:t.commentData,scoll:{x:!0},size:"default",columns:t.columns},scopedSlots:t._u([{key:"userName",fn:function(e,a){return[n("span",[a.userName&&a.userName.replace(/[\u0391-\uFFE5]/g,"aa").length>14?n("a-tooltip",{key:a.userName,attrs:{title:a.userName}},[t._v(t._s(a.userName.slice(0,14)+"..."))]):n("span",[t._v(t._s(a.userName))])],1)]}},{key:"title1",fn:function(e,a){return[n("span",[a.title&&a.title.replace(/[\u0391-\uFFE5]/g,"aa").length>14?n("a-tooltip",{key:a.title,attrs:{title:a.title}},[t._v(t._s(a.title.slice(0,14)+"..."))]):n("span",[t._v(t._s(a.title))])],1)]}},{key:"concactContent",fn:function(e,a){return[n("span",[a.concactContent&&a.concactContent.replace(/[\u0391-\uFFE5]/g,"aa").length>30?n("a-tooltip",{key:a.concactContent,attrs:{title:a.concactContent}},[t._v(t._s(a.concactContent.slice(0,30)+"..."))]):n("span",[t._v(t._s(a.concactContent))])],1)]}},{key:"content",fn:function(e,a){return[n("span",[a.content&&a.content.replace(/[\u0391-\uFFE5]/g,"aa").length>30?n("a-tooltip",{key:a.content,attrs:{title:a.content}},[t._v(t._s(a.content.slice(0,30)+"..."))]):n("span",[t._v(t._s(a.content))])],1)]}},{key:"action",fn:function(e,a){return n("span",{},[n("a",{attrs:{href:"javascript:;"},on:{click:function(e){return t.reply(a)}}},[t._v("回复")]),n("a-divider",{attrs:{type:"vertical"}}),1==a.status?n("a",{on:{click:function(e){return t.commentUpdate(a,1)}}},[t._v("取消精选")]):n("a",{on:{click:function(e){return t.commentUpdate(a,0)}}},[t._v("设置精选")]),n("a-divider",{attrs:{type:"vertical"}}),n("a-dropdown",[n("a",{staticClass:"ant-dropdown-link"},[t._v("\n                更多\n                "),n("a-icon",{attrs:{type:"down"}})],1),n("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[n("a-menu-item",[1==a.onlyAuthor?n("a",{on:{click:function(e){return t.commentUpdate(a,3)}}},[t._v("仅作者可见 ")]):n("a",{on:{click:function(e){return t.commentUpdate(a,2)}}},[t._v("公开可见")])]),n("a-menu-item",[1==a.isHide?n("a",{on:{click:function(e){return t.commentUpdate(a,5)}}},[t._v("取消隐藏")]):n("a",{on:{click:function(e){return t.commentUpdate(a,4)}}},[t._v("隐藏")])]),n("a-menu-item",[n("a",{on:{click:function(e){return t.onDelete(a)}}},[t._v("删除")])])],1)],1)],1)}}])})],1)],1)],1),n("a-modal",{attrs:{title:"回复",width:"520px",maskClosable:!1,visible:t.replyModal,confirmLoading:t.replyConfirmLoading},on:{ok:t.replyOk,cancel:t.replyCancel}},[n("a-form",{attrs:{form:t.form}},[n("a-form-item",{attrs:{label:"作者","label-col":{span:5},"wrapper-col":{span:6}}},[n("a-input",{directives:[{name:"decorator",rawName:"v-decorator",value:["author"],expression:"['author']"}],attrs:{disabled:""}})],1),n("a-form-item",{attrs:{label:"回复内容","label-col":{span:5},"wrapper-col":{span:16}}},[n("a-textarea",{directives:[{name:"decorator",rawName:"v-decorator",value:["content",{rules:[{max:200,message:"内容长度不得超过200个字"},{required:!0,message:"请输入回复内容"}]}],expression:"['content',{ rules: [{ max: 200, message: '内容长度不得超过200个字' }, { required: true, message: '请输入回复内容'}]}]"}],attrs:{rows:8,placeholder:"请输入回复内容"},on:{change:t.setNum}})],1),n("span",{staticClass:"count"},[t._v(t._s(t.currentNum)+"/200")])],1)],1)],1)},r=[],o=n("795b"),s=n.n(o),c=(n("386d"),n("5176")),i=n.n(c),u=n("e8c4"),l=n("b775"),m=n("9fb0"),d=m["l"];function p(t){return Object(l["b"])({url:d+"/comment/page",method:"post",data:t})}function f(t){return Object(l["b"])({url:d+"/comment/update?commentId="+t.commentId+"&&editType="+t.editType,method:"post"})}function h(t){return Object(l["b"])({url:d+"/comment/toReply",method:"post",data:t})}function v(t){return Object(l["b"])({url:d+"/comment/delComment?commentId="+t,method:"post"})}var b=n("5040"),g=n("af85"),y=n("a026"),w=new y["a"],C={name:"CommentListPage",components:{STable:u["a"]},data:function(){var t=this;return{searchCol:g["b"],replyData:[],columns:[{title:"发表者昵称",dataIndex:"userName",width:"150px",align:"center",scopedSlots:{customRender:"userName"}},{title:"类型",dataIndex:"type",width:"100px",align:"center",customRender:function(t){return 0===t?"评论":"回复"}},{title:"来源文章",dataIndex:"title",width:"200px",align:"center",scopedSlots:{customRender:"title1"}},{title:"关联评论",dataIndex:"concactContent",width:"300px",align:"center",scopedSlots:{customRender:"concactContent"}},{title:"内容",dataIndex:"content",width:"300px",align:"center",scopedSlots:{customRender:"content"}},{title:"是否精选",dataIndex:"status",width:"150px",align:"center",customRender:function(t){return 1===t?"是":"否"}},{title:"发表时间",dataIndex:"createDate",width:"200px",align:"center"},{title:"操作",dataIndex:"action",width:"250px",align:"center",scopedSlots:{customRender:"action"}}],form:this.$form.createForm(this),commentData:function(e){return p(i()(t.searchData,{userName:"",pageNum:e.pageNum,pageSize:e.pageSize})).then(function(e){if(e.result)return e.object;t.$message.error(e.message);var n={size:100,current:1,pages:1,total:5,records:[]};return n})},searchData:{},windowWidth:document.body.clientWidth,replyModal:!1,replyConfirmLoading:!1,currentNum:0,replyContent:"",authoer:"",parameter:{}}},created:function(){var t=this;w.$on("success",function(){t.$refs.table.refresh(!0),t.$message.success("操作成功")}),w.$on("error",function(e){t.$message.error(e)}),this.visible=!0},mounted:function(){var t=this;window.onresize=function(){return function(){document.body.clientWidth>1427?t.windowWidth=document.body.clientWidth:t.windowWidth=770}()}},methods:{edit:function(t){this.$refs.modal.edit(!0,t)},onDelete:function(t){var e=this;this.$confirm({title:"是否确认删除?",style:"top: 270px;",onOk:function(){v(t.id).then(function(t){t.result?(e.$message.success("操作成功"),e.search()):e.$message.error("操作失败",t.message)})},onCancel:function(){}})},handleSaveOk:function(){},handleSaveClose:function(){},withDraw:function(t){this.$confirm({title:"是否确认下架?",style:"top: 270px;",onOk:function(){Object(b["b"])(t.id).then(function(t){t.result?w.$emit("success"):w.$emit("error",t.message)}).catch(function(t){w.$emit("error","操作失败"+t)})},onCancel:function(){}})},onExport:function(){this.$confirm({title:"是否确认导出?",style:"top: 270px;",onOk:function(){new s.a(function(t){setTimeout(function(){return t()},1e3)}).then(function(){w.$emit("success")}).catch(function(t){w.$emit("error","操作失败"+t)})},onCancel:function(){}})},search:function(){var t=this;this.form.validateFields(function(e,n){e||(t.searchData.userName=void 0!==n.userName?n.userName:null,t.searchData.fromText=void 0!==n.fromText?n.fromText:null,t.$refs.table.refresh(!0))})},reset:function(){this.form.resetFields()},reply:function(t){var e=this;setTimeout(function(){e.form.setFieldsValue({author:t.userName,content:e.replyContent})},0),this.authoer=t.userName,this.parameter.authotId=t.authotId,this.parameter.fromId=t.fromId,this.parameter.parentId=t.Id,this.parameter.status=t.status,this.parameter.toUserId=t.userId,this.currentNum=0,this.replyModal=!0},replyOk:function(t){var e=this;t.preventDefault(),this.form.validateFields(function(t,n){t||(e.parameter.content=n.content,h(e.parameter).then(function(t){!0===t.result?(e.$message.success("操作成功"),e.replyModal=!1,e.search()):e.$message.error(t.message)}))})},replyCancel:function(){this.replyModal=!1},commentUpdate:function(t,e){var n=this,a={};a.commentId=t.id,a.editType=e,f(a).then(function(t){!0===t.result?(n.$message.success("操作成功"),n.search()):n.$message.error(t.message)})},setNum:function(t){this.currentNum=t.target.value.length}}},x=C,_=(n("0209"),n("2877"));n.d(e,"ref",function(){return w});var k=Object(_["a"])(x,a,r,!1,null,"2cd8bb90",null);e["default"]=k.exports}}]);